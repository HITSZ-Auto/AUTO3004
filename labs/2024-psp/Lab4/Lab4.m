% 1. 用Simulink建立一个如下图所示的典型 PID 控制系统模型
% 输入信号r(t)选为单位阶跃信号，输出端接示波器，Kd=0.01,Ki=4,Kp=2

% 计算 LQR 控制器的最优增益矩阵 K
clc, clear, close all;
A = [0 1 0 0;
     41.6300 0 0 0;
     0 0 0 1;
     -0.6099 0 0 0];
B = [0; -2.7584; 0; 0.6898];
C = [1 0 0 0;
     0 0 1 0];
Q = diag([250 0 10 0]);
R = 0.1;
K = lqr(A, B, Q, R);
disp('K = ');
disp(K);
